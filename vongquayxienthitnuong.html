<!doctype html>
<html lang="vi">

<head>
Â  Â  <meta charset="utf-8" />
Â  Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  Â  <title>XiÃªn Thá»‹t NÆ°á»›ng May Máº¯n</title>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
Â  Â  <style>

Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --size: 380px;
Â  Â  Â  Â  Â  Â  --pointer-size: 30px;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  font-family: "Nunito", sans-serif;
Â  Â  display: flex;
Â  Â  gap: 24px;
Â  Â  align-items: center; Â  Â  Â  Â /* âœ” giá»¯a chiá»u dá»c */
Â  Â  justify-content: center; Â  Â /* âœ” giá»¯a chiá»u ngang */
Â  Â  min-height: 100vh;
Â  Â  margin: 0;
Â  Â  /* Giáº£ sá»­ báº¡n cÃ³ file thit.png trong thÆ° má»¥c nÃ y. Náº¿u khÃ´ng, hÃ£y thay tháº¿ báº±ng mÃ u ná»n hoáº·c Ä‘Æ°á»ng dáº«n khÃ¡c */
Â  Â  background: url('thit.png') no-repeat center center; 
Â  Â  background-size: cover;
Â  Â  color: #000000;
Â  Â  box-sizing: border-box;
Â  Â  padding: 0;
}
Â  Â  h1, h2, h3, .wheel-center, button, .tag, label {
Â  Â  Â  Â  font-family: "Poppins", sans-serif !important;
Â  Â  Â  Â  font-weight: 700;
Â  Â  }

Â  Â  svg text {
Â  Â  Â  Â  font-family: "Poppins", sans-serif !important;
Â  Â  }
Â  Â  Â  Â  /* Left: Wheel area */
Â  Â  Â  Â  .wheel-wrap {
Â  Â  Â  Â  Â  Â  width: var(--size);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 16px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .wheel {
Â  Â  Â  Â  Â  Â  width: var(--size);
Â  Â  Â  Â  Â  Â  height: var(--size);
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(20, 30, 60, 0.12), inset 0 2px 8px rgba(4, 255, 222, 0.05);
Â  Â  Â  Â  Â  Â  transition: transform 1s cubic-bezier(.15, .85, .22, 1);
Â  Â  Â  Â  Â  Â  will-change: transform;
Â  Â  Â  Â  Â  Â  overflow: visible;
Â  Â  Â  Â  }

Â  Â  Â  Â  .wheel-center {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  width: 28%;
Â  Â  Â  Â  Â  Â  height: 28%;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  background: rgba(0, 0, 0, 0);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
Â  Â  Â  Â  }

.pointer {
Â  Â  width: 8px; Â  Â  Â  Â /* thÃ¢n mÅ©i tÃªn */
Â  Â  height: 50px;
Â  Â  background: #ff0004;
Â  Â  position: relative;
Â  Â  margin: 0 auto;
Â  Â  top: 30px; Â  Â  Â  Â  /* Ä‘áº·t trÃªn vÃ²ng quay */
Â  Â  left: 1%;
Â  Â  transform: translateX(-50%);
Â  Â  z-index: 10; Â  Â  Â /* luÃ´n ná»•i trÃªn bÃ¡nh */
Â  Â  border-radius: 4px;
Â  Â  filter: drop-shadow(0 3px 6px rgba(0,0,0,0.2));
}

.pointer::after {
Â  Â  content: '';
Â  Â  position: absolute;
Â  Â  top: 40px; Â  Â  Â  Â  Â  /* ná»‘i Ä‘áº§u mÅ©i vá»›i thÃ¢n */
Â  Â  left: 50%;
Â  Â  transform: translateX(-50%) rotate(180deg); /* xoay tam giÃ¡c xuá»‘ng */
Â  Â  width: 20px;
Â  Â  height: 20px;
Â  Â  background: #ff0004;
Â  Â  clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
}


Â  Â  Â  Â  /* Controls */
Â  Â  Â  Â  .controls {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }

Â  Â  Â  Â  button {
Â  Â  Â  Â  Â  Â  background: #0b76ff;
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  Â  Â  border: 0;
Â  Â  Â  Â  Â  Â  padding: 10px 16px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  button:disabled {
Â  Â  Â  Â  Â  Â  opacity: 0.6;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Right: Name input and results */
Â  Â  Â  Â  .panel {
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  width: 320px;
Â  Â  Â  Â  Â  Â  max-width: calc(100vw - 64px);
Â  Â  Â  Â  Â  Â  background: #fdbf85 ;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 16px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 12px 30px rgba(255, 0, 0, 0.08);
Â  Â  Â  Â  }

Â  Â  Â  Â  textarea {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 220px;
Â  Â  Â  Â  Â  Â  resize: vertical;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  border: 1px solid #FFD166;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  label {
Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .result {
Â  Â  Â  Â  Â  Â  margin-top: 12px;
Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  background: linear-gradient(90deg, #FFD166, #fffbed);
Â  Â  Â  Â  Â  Â  border: 1px solid #FFD166;
Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .small {
Â  Â  Â  Â  Â  Â  font-size: 13px;
Â  Â  Â  Â  Â  Â  color: #ff0000;
Â  Â  Â  Â  Â  Â  margin-top: 8px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .preset {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  Â  Â  margin-top: 8px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .tag {
Â  Â  Â  Â  Â  Â  background: #f1f7ff;
Â  Â  Â  Â  Â  Â  color: #0b76ff;
Â  Â  Â  Â  Â  Â  padding: 6px 8px;
Â  Â  Â  Â  Â  Â  border-radius: 999px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  border: 1px solid #ddebff;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Responsive */
Â  Â  Â  Â  @media (max-width:900px) {
Â  Â  Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  .panel {
Â  Â  Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  }
Â  Â  </style>
</head>

<body>

Â  Â  <div class="wheel-wrap" aria-hidden="false">
Â  Â  Â  Â  <div class="pointer" title="Pointer"></div>
Â  Â  Â  Â  <div id="wheel" class="wheel" role="img" aria-label="VÃ²ng quay may máº¯n">
Â  Â  Â  Â  Â  Â  <b><center><div class="wheel-center">VÃ’NG QUAY MAY Máº®N</div></center></b>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="controls">
Â  Â  Â  Â  Â  Â  <big><button id="spinBtn">Quay</button></big>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <b><div class="big"></div></b>
Â  Â  </div>

Â  Â  <div class="panel" aria-hidden="false">
Â  Â  Â  Â  <label for="names">Danh sÃ¡ch tÃªn (má»—i tÃªn 1 dÃ²ng)</label>
Â  Â  Â  Â  <textarea id="names" placeholder="VÃ­ dá»¥:Nháº­p nhá»› xuá»‘ng dÃ²ng nha"></textarea>

Â  Â  Â  Â  <div class="preset">
Â  Â  Â  Â  Â  Â  <center> <div class="tag" data-set="group1">Danh SÃ¡ch</div></center>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <div class="result" id="result" aria-live="polite">ChÆ°a quay</div>
Â  Â  Â  Â  <b><big><n><div class="small">Káº¿t quáº£ sáº½ xuáº¥t hiá»‡n á»Ÿ Ä‘Ã¢y ngay sau khi káº¿t thÃºc.</div></big></b>

Â  Â  Â  Â  <div class="history-panel">
Â  Â  Â  Â  Â  Â  <h3>Lá»‹ch sá»­ quay</h3>
Â  Â  Â  Â  Â  Â  <div id="history-scroll-container">
Â  Â  Â  Â  Â  Â  Â  Â  <table id="historyTable">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>STT</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>TÃªn</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Káº¿t quáº£</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Thá»i gian</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <style>
Â  Â  Â  Â  Â  Â  .history-panel {
Â  Â  Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  Â  Â  background: #fff3e0;
Â  Â  Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  .history-panel h3 {
Â  Â  Â  Â  Â  Â  Â  Â  margin: 0 0 8px 0;
Â  Â  Â  Â  Â  Â  Â  Â  font-family: "Poppins", sans-serif;
Â  Â  Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  /* CSS Má»šI: Giá»›i háº¡n chiá»u cao vÃ  thÃªm thanh cuá»™n */
Â  Â  Â  Â  Â  Â  #history-scroll-container {
Â  Â  Â  Â  Â  Â  Â  Â  /* Giáº£ Ä‘á»‹nh chiá»u cao cá»§a 1 hÃ ng (row) lÃ  khoáº£ng 30px */
Â  Â  Â  Â  Â  Â  Â  Â  /* 3 hÃ ng * 30px = 90px. Äáº·t Max-height khoáº£ng 100px lÃ  Ä‘á»§ cho 3 hÃ ng */
Â  Â  Â  Â  Â  Â  Â  Â  max-height: 100px;
Â  Â  Â  Â  Â  Â  Â  Â  overflow-y: auto; /* Báº­t thanh cuá»™n dá»c khi ná»™i dung vÆ°á»£t quÃ¡ chiá»u cao */
Â  Â  Â  Â  Â  Â  Â  Â  border: 1px solid #ffd166; /* ThÃªm viá»n Ä‘á»ƒ dá»… nhÃ¬n khi cÃ³ thanh cuá»™n */
Â  Â  Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  /* Äáº£m báº£o tiÃªu Ä‘á» báº£ng (thead) khÃ´ng bá»‹ cuá»™n cÃ¹ng ná»™i dung (body) */
Â  Â  Â  Â  Â  Â  #historyTable thead {
Â  Â  Â  Â  Â  Â  Â  Â  display: table;
Â  Â  Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  Â  Â  table-layout: fixed;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  /* Äiá»u chá»‰nh kÃ­ch thÆ°á»›c tbody Ä‘á»ƒ cuá»™n Ä‘Æ°á»£c */
Â  Â  Â  Â  Â  Â  #historyTable tbody {
Â  Â  Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  Â  Â  height: auto; /* Chiá»u cao tá»± Ä‘á»™ng dá»±a trÃªn ná»™i dung cuá»™n */
Â  Â  Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  /* Äiá»u chá»‰nh cÃ¡c cá»™t trong tbody khá»›p vá»›i thead */
Â  Â  Â  Â  Â  Â  #historyTable tbody tr {
Â  Â  Â  Â  Â  Â  Â  Â  display: table;
Â  Â  Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  Â  Â  table-layout: fixed;
Â  Â  Â  Â  Â  Â  }


Â  Â  Â  Â  Â  Â  #historyTable {
Â  Â  Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  Â  Â  border-collapse: collapse;
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  #historyTable th, #historyTable td {
Â  Â  Â  Â  Â  Â  Â  Â  /* Bá» viá»n cÅ© trÃªn table vÃ  thÃªm viá»n vÃ o container Ä‘á»ƒ cuá»™n mÆ°á»£t hÆ¡n */
Â  Â  Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  Â  Â  border-bottom: 1px solid #ffd166;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 6px 8px;
Â  Â  Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  /* KhÃ´i phá»¥c border left/right cho Ã´ */
Â  Â  Â  Â  Â  Â  Â #historyTable th:not(:last-child), #historyTable td:not(:last-child) {
Â  Â  Â  Â  Â  Â  Â  Â  border-right: 1px solid #ffd166;
Â  Â  Â  Â  Â  Â  }


Â  Â  Â  Â  Â  Â  #historyTable th {
Â  Â  Â  Â  Â  Â  Â  Â  background: #ffd166;
Â  Â  Â  Â  Â  Â  Â  Â  color: #000;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  </style>
Â  Â  </div>

Â  Â  <script>
Â  Â  /*
Â  Â  Â  CÃ¡ch hoáº¡t Ä‘á»™ng:
Â  Â  Â  - Láº¥y danh sÃ¡ch tÃªn (má»—i tÃªn 1 dÃ²ng).
Â  Â  Â  - Váº½ bÃ¡nh (sá»­ dá»¥ng conic-gradient) vá»›i má»—i lÃ¡t á»©ng vá»›i 1 tÃªn.
Â  Â  Â  - Khi nháº¥n "Quay", chá»n 1 chá»‰ sá»‘ ngáº«u nhiÃªn, tÃ­nh gÃ³c xoay sao cho chá»‰ sá»‘ Ä‘Ã³ vÃ o vá»‹ trÃ­ pointer (top).
Â  Â  Â  - ThÃªm nhiá»u vÃ²ng quay (spins) Ä‘á»ƒ cÃ³ hiá»‡u á»©ng Ä‘áº¹p.
Â  Â  */

Â  Â  const wheel = document.getElementById('wheel');
Â  Â  const spinBtn = document.getElementById('spinBtn');
Â  Â  const namesInput = document.getElementById('names');
Â  Â  const resultDiv = document.getElementById('result');
Â  Â  const presetTags = document.querySelectorAll('.tag');

Â  Â  // --- Bá»• sung cho Lá»‹ch sá»­ Quay ---
Â  Â  const historyTableBody = document.querySelector('#historyTable tbody');
Â  Â  
Â  Â  /**
Â  Â  Â * ThÃªm má»™t hÃ ng má»›i vÃ o báº£ng lá»‹ch sá»­.
Â  Â  Â * HÃ ng má»›i nháº¥t Ä‘Æ°á»£c CHÃˆN VÃ€O CUá»I Báº¢NG (sáº½ hiá»‡n á»Ÿ DÆ¯á»šI)
Â  Â  Â * vÃ  cÃ³ STT tiáº¿p theo (1, 2, 3...).
Â  Â  Â * @param {string} result Káº¿t quáº£ trÃºng thÆ°á»Ÿng
Â  Â  Â */
Â  Â  function addHistoryEntry(result) {
Â  Â  Â  Â  
Â  Â  Â  Â  // Láº¥y thá»i gian hiá»‡n táº¡i theo Ä‘á»‹nh dáº¡ng HH:MM:SS
Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  const timeString = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;

Â  Â  Â  Â  // QUAN TRá»ŒNG: Táº¡o hÃ ng má»›i
Â  Â  Â  Â  const newRow = document.createElement('tr');
Â  Â  Â  Â  
Â  Â  Â  Â  // Táº¡o cÃ¡c Ã´ (cells)
Â  Â  Â  Â  const cellStt = newRow.insertCell(0);
Â  Â  Â  Â  const cellName = newRow.insertCell(1); // Ã” TÃªn (giá»¯ trá»‘ng)
Â  Â  Â  Â  const cellResult = newRow.insertCell(2);
Â  Â  Â  Â  const cellTime = newRow.insertCell(3);

Â  Â  Â  Â  // Äáº·t ná»™i dung
Â  Â  Â  Â  cellName.textContent = ''; // Giá»¯ Ã´ nÃ y trá»‘ng náº¿u khÃ´ng cÃ³ ngÆ°á»i chÆ¡i
Â  Â  Â  Â  cellResult.textContent = result;
Â  Â  Â  Â  cellTime.textContent = timeString;

Â  Â  Â  Â  // CHá»ˆNH Sá»¬A QUAN TRá»ŒNG: CHÃˆN HÃ€NG Má»šI VÃ€O Vá»Š TRÃ CUá»I (appendChild)
Â  Â  Â  Â  // Äiá»u nÃ y Ä‘áº£m báº£o báº£n ghi má»›i nháº¥t luÃ´n á»Ÿ cuá»‘i báº£ng (phÃ­a dÆ°á»›i)
Â  Â  Â  Â  historyTableBody.appendChild(newRow); 
Â  Â  Â  Â  
Â  Â  Â  Â  // Cáº¬P NHáº¬T Láº I Sá» THá»¨ Tá»° (STT) CHO Táº¤T Cáº¢ CÃC HÃ€NG
Â  Â  Â  Â  const totalRows = historyTableBody.rows.length;
Â  Â  Â  Â  for (let i = 0; i < totalRows; i++) {
Â  Â  Â  Â  Â  Â  // HÃ ng á»Ÿ vá»‹ trÃ­ i (tá»« 0) sáº½ cÃ³ STT lÃ  i + 1
Â  Â  Â  Â  Â  Â  const stt = i + 1;
Â  Â  Â  Â  Â  Â  historyTableBody.rows[i].cells[0].textContent = stt;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Bá»• sung: Cuá»™n xuá»‘ng cuá»‘i Ä‘á»ƒ tháº¥y hÃ ng má»›i nháº¥t
Â  Â  Â  Â  const scrollContainer = document.getElementById('history-scroll-container');
Â  Â  Â  Â  scrollContainer.scrollTop = scrollContainer.scrollHeight;
Â  Â  }
Â  Â  // --- Káº¿t thÃºc pháº§n bá»• sung cho Lá»‹ch sá»­ Quay ---


Â  Â  // Helper: clean names array
Â  Â  function getNames() {
Â  Â  Â  Â  const raw = namesInput.value.split('\n').map(s => s.trim()).filter(Boolean);
Â  Â  Â  Â  // unique and keep order:
Â  Â  Â  Â  const seen = new Set();
Â  Â  Â  Â  const out = [];
Â  Â  Â  Â  for (const n of raw) {
Â  Â  Â  Â  Â  Â  if (!seen.has(n)) { seen.add(n); out.push(n); }
Â  Â  Â  Â  }
Â  Â  Â  Â  return out;
Â  Â  }

Â  Â  // Render wheel using CSS conic-gradient and label slices using SVG overlay
Â  Â  function renderWheel(names) {
Â  Â  Â  Â  if (!names.length) {
Â  Â  Â  Â  Â  Â  wheel.style.background = 'conic-gradient(#f5f6fb, #eef2ff)';
Â  Â  Â  Â  Â  Â  // remove labels if any
Â  Â  Â  Â  Â  Â  const existing = wheel.querySelector('svg');
Â  Â  Â  Â  Â  Â  if (existing) existing.remove();
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  const colors = [
Â  Â  Â  Â  Â  Â  '#ffd8d8', '#ffe7d1', '#fff7d1', '#eaffd1', '#d0ffe7', '#d1f7ff', '#dfe4ff', '#f4dfff'
Â  Â  Â  Â  ];
Â  Â  Â  Â  // make gradient with alternating colors
Â  Â  Â  Â  const slice = 360 / names.length;
Â  Â  Â  Â  let gradientParts = [];
Â  Â  Â  Â  for (let i = 0; i < names.length; i++) {
Â  Â  Â  Â  Â  Â  const color = colors[i % colors.length];
Â  Â  Â  Â  Â  Â  const start = (i * slice).toFixed(6);
Â  Â  Â  Â  Â  Â  const end = ((i + 1) * slice).toFixed(6);
Â  Â  Â  Â  Â  Â  gradientParts.push(`${color} ${start}deg ${end}deg`);
Â  Â  Â  Â  }
Â  Â  Â  Â  wheel.style.background = `conic-gradient(${gradientParts.join(',')})`;

Â  Â  Â  Â  // create SVG labels if not exist or replace
Â  Â  Â  Â  let svg = wheel.querySelector('svg');
Â  Â  Â  Â  if (svg) svg.remove();
Â  Â  Â  Â  svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
Â  Â  Â  Â  svg.setAttribute('viewBox', '0 0 100 100');
Â  Â  Â  Â  svg.setAttribute('width', '100%');
Â  Â  Â  Â  svg.setAttribute('height', '100%');
Â  Â  Â  Â  svg.style.position = 'absolute';
Â  Â  Â  Â  svg.style.left = 0;
Â  Â  Â  Â  svg.style.top = 0;
Â  Â  Â  Â  svg.style.pointerEvents = 'none';

Â  Â  Â  Â  const cx = 50, cy = 50, r = 45;
Â  Â  Â  Â  const sliceAngle = 360 / names.length;
Â  Â  Â  Â  for (let i = 0; i < names.length; i++) {
Â  Â  Â  Â  Â  Â  const midAngle = (i * sliceAngle + sliceAngle / 2) - 90; // -90 so 0deg is top
Â  Â  Â  Â  Â  Â  const rad = midAngle * Math.PI / 180;
Â  Â  Â  Â  Â  Â  const tx = cx + Math.cos(rad) * (r * 0.62);
Â  Â  Â  Â  Â  Â  const ty = cy + Math.sin(rad) * (r * 0.62);

Â  Â  Â  Â  Â  Â  const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
Â  Â  Â  Â  Â  Â  text.setAttribute('x', tx);
Â  Â  Â  Â  Â  Â  text.setAttribute('y', ty);
Â  Â  Â  Â  Â  Â  text.setAttribute('font-size', 3.8);
Â  Â  Â  Â  Â  Â  text.setAttribute('text-anchor', 'middle');
Â  Â  Â  Â  Â  Â  text.setAttribute('dominant-baseline', 'middle');
Â  Â  Â  Â  Â  Â  text.setAttribute('fill', '#223');
Â  Â  Â  Â  Â  Â  text.setAttribute('style', `font-weight:700; font-family: sans-serif;`);
Â  Â  Â  Â  Â  Â  // rotate text so it reads along radius
Â  Â  Â  Â  Â  Â  const rotateAngle = midAngle + 90;
Â  Â  Â  Â  Â  Â  text.setAttribute('transform', `rotate(${rotateAngle} ${tx} ${ty})`);
Â  Â  Â  Â  Â  Â  const name = names[i];
Â  Â  Â  Â  Â  Â  // shorten if too long
Â  Â  Â  Â  Â  Â  const short = name.length > 18 ? name.slice(0, 16) + 'â€¦' : name;
Â  Â  Â  Â  Â  Â  text.textContent = short;
Â  Â  Â  Â  Â  Â  svg.appendChild(text);
Â  Â  Â  Â  }

Â  Â  Â  Â  wheel.appendChild(svg);
Â  Â  }

Â  Â  // Compute rotation so that chosen index lands at top pointer
Â  Â  function computeRotationForIndex(index, count, extraSpins = 6) {
Â  Â  Â  Â  const slice = 360 / count;
Â  Â  Â  Â  // center angle (deg) for that slice measured from 0deg at top going clockwise
Â  Â  Â  Â  const targetAngle = index * slice + slice / 2;
Â  Â  Â  Â  // We need to rotate the wheel so that targetAngle ends up at 0deg (top).
Â  Â  Â  Â  // If wheel is rotated by R deg clockwise, then a point at angle A will move to (A + R) mod 360.
Â  Â  Â  Â  // We want (targetAngle + R) % 360 = 0 Â => Â R = 360 - targetAngle (mod 360)
Â  Â  Â  Â  const align = (360 - targetAngle) % 360;
Â  Â  Â  Â  const total = 360 * extraSpins + align;
Â  Â  Â  Â  return total;
Â  Â  }

Â  Â  // Spin action
Â  Â  function forceReflow() {
Â  Â  Â  Â  void wheel.offsetWidth;
Â  Â  }
Â  Â  let spinning = false;
Â  Â  spinBtn.addEventListener('click', () => {
Â  Â  Â  Â  const names = getNames();
Â  Â  Â  Â  if (spinning) return;
Â  Â  Â  Â  if (!names.length) {
Â  Â  Â  Â  Â  Â  alert('Vui lÃ²ng nháº­p Ã­t nháº¥t 1 tÃªn á»Ÿ khung bÃªn pháº£i.');
Â  Â  Â  Â  Â  Â  namesInput.focus();
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  spinning = true;
Â  Â  Â  Â  spinBtn.disabled = true;
Â  Â  Â  Â  resultDiv.textContent = 'Äang quay...';
Â  Â  Â  Â  // choose random index
Â  Â  Â  Â  Â  let chosenName;

Â  Â  Â  Â  // Táº¡o cÆ¡ cháº¿ xÃ¡c suáº¥t:
Â  Â  Â  Â  // 98% ra "ChÃºc báº¡n may máº¯n láº§n sau"
Â  Â  Â  Â  // 2% ra 1 trong cÃ¡c pháº§n thÆ°á»Ÿng khÃ¡c
Â  Â  Â  Â  if (Math.random() < 0.98) {
Â  Â  Â  Â  Â  Â  chosenName = "ChÃºc báº¡n may máº¯n láº§n sauğŸ˜¢";
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // chá»n ngáº«u nhiÃªn trong danh sÃ¡ch pháº§n thÆ°á»Ÿng khÃ¡c
Â  Â  Â  Â  Â  Â  const rewards = names.filter(n => n !== "ChÃºc báº¡n may máº¯n láº§n sauğŸ˜¢");
Â  Â  Â  Â  Â  Â  chosenName = rewards.length ? rewards[Math.floor(Math.random() * rewards.length)] : "ChÃºc báº¡n may máº¯n láº§n sauğŸ˜¢";
Â  Â  Â  Â  }

Â  Â  Â  Â  // tÃ¬m index trong wheel (náº¿u cÃ³)
Â  Â  Â  Â  let idx = names.indexOf(chosenName);
Â  Â  Â  Â  if (idx === -1) idx = 0; // fallback

Â  Â  Â  Â  const rotation = computeRotationForIndex(idx, names.length, 1 + Math.floor(Math.random() * 1));
Â  Â  Â  Â  Â  Â  // apply transform
Â  Â  Â  Â  Â  Â  Â  wheel.style.transition = "none";
Â  Â  Â  Â  Â  Â  wheel.style.transform = "rotate(0deg)";
Â  Â  Â  Â  Â  Â  forceReflow(); // Ã©p trÃ¬nh duyá»‡t cáº­p nháº­t

Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  wheel.style.transition = 'transform 1s cubic-bezier(.15,.85,.22,1)';
Â  Â  Â  Â  Â  Â  wheel.style.transform = `rotate(${rotation}deg)`;

Â  Â  Â  Â  Â  Â  // after animation end, reveal winner
Â  Â  Â  Â  Â  Â  const timeout = 1000; // ÄÃ£ tÄƒng lÃªn 1000ms cho an toÃ n
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  spinning = false;
Â  Â  Â  Â  Â  Â  Â  Â  spinBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  // normalize final rotation to [0,360)
Â  Â  Â  Â  Â  Â  Â  Â  const finalRotation = rotation % 360;
Â  Â  Â  Â  Â  Â  Â  Â  // compute winning index again to be safe
Â  Â  Â  Â  Â  Â  Â  Â  const slice = 360 / names.length;
Â  Â  Â  Â  Â  Â  Â  Â  // winner center angle = (360 - finalRotation) % 360
Â  Â  Â  Â  Â  Â  Â  Â  const winnerAngle = (360 - finalRotation) % 360;
Â  Â  Â  Â  Â  Â  Â  Â  let winnerIndex = Math.floor((winnerAngle) / slice);
Â  Â  Â  Â  Â  Â  Â  Â  // because we mapped mid-angle, adjust by rounding
Â  Â  Â  Â  Â  Â  Â  Â  // compute distances to slice centers and select closest
Â  Â  Â  Â  Â  Â  Â  Â  let best = 0, bestDiff = 1e9;
Â  Â  Â  Â  Â  Â  Â  Â  for (let i = 0; i < names.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const center = (i * slice + slice / 2) % 360;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let diff = Math.abs(((center - winnerAngle + 540) % 360) - 180); // wrapped diff
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (diff < bestDiff) { bestDiff = diff; best = i; }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  winnerIndex = best;
Â  Â  Â  Â  Â  Â  Â  Â  const winner = names[winnerIndex];
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // Cáº­p nháº­t káº¿t quáº£ trÃºng thÆ°á»Ÿng
Â  Â  Â  Â  Â  Â  Â  Â  resultDiv.textContent = ` Báº¡n Ä‘Ã£ nháº­n Ä‘Æ°á»£c: ${winner}`;

Â  Â  Â  Â  Â  Â  Â  Â  // Gá»ŒI HÃ€M LÆ¯U Lá»ŠCH Sá»¬ (ÄÃƒ CHá»ˆNH Sá»¬A)
Â  Â  Â  Â  Â  Â  Â  Â  addHistoryEntry(winner);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // add small highlight pulse to the center
Â  Â  Â  Â  Â  Â  Â  Â  const center = wheel.querySelector('.wheel-center');
Â  Â  Â  Â  Â  Â  Â  Â  center.textContent = winner;
Â  Â  Â  Â  Â  Â  Â  Â  center.animate([
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { transform: 'translate(-50%,-50%) scale(1)' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { transform: 'translate(-50%,-50%) scale(1.06)' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { transform: 'translate(-50%,-50%) scale(1)' }
Â  Â  Â  Â  Â  Â  Â  Â  ], { duration: 900, easing: 'ease-out' });
Â  Â  Â  Â  Â  Â  }, timeout);
Â  Â  });

Â  Â  // When names change, re-render wheel
Â  Â  namesInput.addEventListener('input', () => {
Â  Â  Â  Â  renderWheel(getNames());
Â  Â  Â  Â  // reset wheel rotation so it shows new pattern
Â  Â  Â  Â  wheel.style.transition = 'none';
Â  Â  Â  Â  wheel.style.transform = 'rotate(0deg)';
Â  Â  Â  Â  wheel.querySelector('.wheel-center').textContent = '20K/1 LÆ°á»£t';
Â  Â  Â  Â  resultDiv.textContent = 'ChÆ°a quay';
Â  Â  });
Â  Â  
Â  Â  // Load preset names on tag click
Â  Â  presetTags.forEach(tag => {
Â  Â  Â  Â  tag.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const dataset = tag.getAttribute('data-set');
Â  Â  Â  Â  Â  Â  let presetNames = '';
Â  Â  Â  Â  Â  if (dataset === 'group1') {
Â  Â  Â  Â  Â  Â  Â  Â  // Cáº­p nháº­t danh sÃ¡ch máº«u cho dá»… kiá»ƒm tra
Â  Â  Â  Â  Â  Â  Â  Â  presetNames = "ChÃºc má»«ng báº¡n Ä‘Ã£ trÃºng 2 xiÃªn thá»‹t nÆ°á»›ngğŸ¥³\nChÃºc báº¡n may máº¯n láº§n sauğŸ˜¢\nTrÃºng 1 ly nÆ°á»›c ngá»t Coca Cola\nHoÃ n tiá»n 10K\nThÃªm 1 lÆ°á»£t quay miá»…n phÃ­";
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  namesInput.value = presetNames;
Â  Â  Â  Â  Â  Â  namesInput.dispatchEvent(new Event("input"));
Â  Â  Â  Â  });
Â  Â  });

Â  Â  // initial example
Â  Â  namesInput.value = "ChÃºc má»«ng báº¡n Ä‘Ã£ trÃºng 2 xiÃªn thá»‹t nÆ°á»›ngğŸ¥³\nChÃºc báº¡n may máº¯n láº§n sauğŸ˜¢";
Â  Â  namesInput.dispatchEvent(new Event("input"));


Â  Â  // a11y: allow Enter key on spin button
Â  Â  spinBtn.addEventListener('keydown', (e) => {
Â  Â  Â  Â  if (e.key === 'Enter') spinBtn.click();
Â  Â  Â  Â  
Â  Â  });
</script>

</body>


</html>